<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Statistical Computing</title>

    <meta name="author" content="Xi (Rossi) LUO">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="reveal.js.4.1.3/dist/reset.css">
    <link rel="stylesheet" href="reveal.js.4.1.3/dist/reveal.css">
    <!-- <link rel="stylesheet" href="reveal.js.4.1.3/dist/theme/white.css" id="theme"> -->



    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="reveal.js.4.1.3/plugin/highlight/github-dark-dimmed.min.css">
    <!--
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css">
-->
    <link rel="stylesheet" href="./css/rossisimple.css" id="theme">
    <!--    <link rel="stylesheet" href="./css/brightRoom.css" id="theme">-->
</head>

<body>

    <div class="reveal">

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">

            <!--      place holder for credits: empty for now -->
            <credit></credit>
            <!-- <style>
                .rds_db credit:after {
                    content: "https://r4ds.had.co.nz/relational-data.html";
                }
            </style> -->
            <section>
                <h1><strong>
                        <highlight>Statistical</highlight>
                        <emph>Computing</emph>
                    </strong></h1>
                <br>
                <h2>Wrangle</h2>
                <br>

                <h3>Xi (Rossi) <strong>LUO</strong></h3>
                <br>
                <p><small>Department of Biostatistics and Data Science<br>
                        School of Public Health<br>The University of Texas Health Science Center at Houston</small></p>
            </section>


            <section>
                <h2>Data Exploration</h2>
                <img src="https://d33wubrfki0l68.cloudfront.net/795c039ba2520455d833b4034befc8cf360a70ba/558a5/diagrams/data-science-explore.png"
                    alt="" width="65%">
                <p>First step to gain (preliminary) insight from data. Visualization is an important, not necessarily
                    sufficient, component.</p>
            </section>


            <section>
                <h2>ggplot2</h2>
                <ul>
                    <li>Grammar of graphics: layered system to plotting</li>
                    <li>Basic R plotting uses a procedural approach to modify components in plots </li>
                    <li>By default, ggplot will select </li>
                </ul>
            </section>


            <section>
                <h2>First Example</h2>
                <pre><code data-trim data-noescape class="language-r">
                    library(tidyverse)
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/91aebc6de4de928abc810433b752274ba6a46d58/a78b1/visualize_files/figure-html/unnamed-chunk-3-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>ggplot()</h2>
                <ul>
                    <li>ggplot() creates a coordinate system, including the data</li>
                    <li>Itself is an empty graph</li>
                    <li>More layers, e.g. geom_point, needed to be added</li>
                    <li>One can add more layers of geom functions, of different types</li>
                    <li>Each geom function takes, <emphcode>mapping</emphcode> arguments, which defines how data are
                        visualized
                        <ul>
                            <li>
                                <emphcode>aes</emphcode> specifies which variables for x and y axes
                            </li>
                        </ul>
                    </li>
                </ul>
            </section>


            <section>
                <h2>Aesthetic Mapping</h2>
                <ul>
                    <li>Aesthetic is visual property of the objects (e.g. points, lines) in plots</li>
                    <li>Examples: size, shape, color</li>
                    <li>Distinct levels mapped to properties automatically by default</li>
                </ul>
            </section>


            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy, color = class))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/8b89c5554ed6108359d59909d441dbeb010e8802/9f366/visualize_files/figure-html/unnamed-chunk-7-1.png"
                    alt="" width="60%">
                <p>Also known as scaling in ggplot2, and legend was added</p>
            </section>


            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy, size = class))
                    #> Warning: Using size for a discrete variable is not advised.
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/9c1b8b7c0700daf7d8d141f892036a0caf83e8d7/4c81a/visualize_files/figure-html/unnamed-chunk-8-1.png"
                    alt="" width="60%">
                <p>Size for ordinal variables usually, and color/shape for categorical</p>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                      geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/f9280bbd15f46cc9d67a8fa30085c147ccee89c4/402ac/visualize_files/figure-html/unnamed-chunk-9-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy, shape = class))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/1ae399aecbf37c65219a1610aa1b9700a6355834/5d06b/visualize_files/figure-html/unnamed-chunk-9-2.png"
                    alt="" width="60%">
                <p>Maximum 6 shapes allowed, additional levels unplotted</p>
            </section>



            <section>
                <h2>Automatic</h2>
                <ul>
                    <li>ggplot2 mapping selects shapes, colors, .. automatically accoding to theory</li>
                    <li>Usually pretty good</li>
                    <li>
                        <emphcode>mapping=aes()</emphcode> lets ggplot2 to select, but one can set manually by using the
                        property names directly
                    </li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy), color = "blue")
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/c36c62d7f70e30e3307295d6408b8d3b61e3c56a/a6987/visualize_files/figure-html/unnamed-chunk-10-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>Exercise</h2>
                <p>Whatâ€™s gone wrong with this code? Why are the points not blue?
                </p>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy, color = "blue"))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/2c3f0abae562f351ef2a3b32066b69101d831900/c4e3b/visualize_files/figure-html/unnamed-chunk-11-1.png"
                    alt="" width="60%">
            </section>


            <section>
                <h2>Facets</h2>
                <ul>
                    <li>If too many cantegories, break up into facets, or suplots that display subset of data</li>
                    <li>Single discrete variable, use <emphcode>facet_wrap</emphcode>
                    </li>
                    <li>Combination of two variables, use <emphcode>facet_grid</emphcode>
                    </li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy)) + 
                    facet_wrap(~ class, nrow = 2)
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/cfc07b44ca9549597084bb18593c6aa115725240/8843c/visualize_files/figure-html/unnamed-chunk-12-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy)) + 
                    facet_grid(drv ~ cyl)
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/c58f7f0f141f26f854d732701592275422e04ec4/0ad69/visualize_files/figure-html/unnamed-chunk-13-1.png"
                    alt="" width="60%">
            </section>


            <section>
                <h2>geoms</h2>
                <ul>
                    <li>Visual object in ggplot2</li>
                    <li>Different geoms represent different data: bar, boxplot, line </li>
                    <li>ggplot2 uses different functions for geoms</li>
                    <li>All functions have similar interfaces, e.g. mapping=aes()</li>
                    <li>Some options may not be available, e.g. lines don't have shpaes</li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/f6d3025401c2bf94d85e1871ea67cddf48b52504/31750/visualize_files/figure-html/unnamed-chunk-19-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>geoms</h2>
                <ul>
                    <li>40 geoms available, and more by extension packages</li>
                    <li>Multiple geoms, together with ggplot, can be added together as a pipe line using <emphcode>+
                        </emphcode>
                    </li>
                    <li>Multiple geoms can have separate aes or shared aes</li>
                </ul>
            </section>


            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy)) +
                    geom_smooth(mapping = aes(x = displ, y = hwy))
                    # Same as
                    ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
                    geom_point() + 
                    geom_smooth()
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/737dd0bae0fa6100c991e2ca6c4f7dea77de7718/a3667/visualize_files/figure-html/unnamed-chunk-22-1.png"
                    alt="" width="60%">

            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
                    geom_point(mapping = aes(color = class)) + 
                    geom_smooth(data = filter(mpg, class == "subcompact"), se = FALSE)
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/5f1620468f0bede8ea7efb83bd82f6409d0ee71e/5d90d/visualize_files/figure-html/unnamed-chunk-25-1.png"
                    alt="" width="60%">
            </section>


            <section>
                <h2>stat</h2>
                <ul>
                    <li>Statistical transformations, known as stat, needed when plotting derived variables (e.g. counts)
                        instead of raw data</li>
                    <li>ggplot2 calculates derived variables using various stat functions</li>
                    <li>Some geoms (e.g. bar charts) calls stat functions under the hood</li>
                    <li>Every geom has a default stat; and every stat has a default geom</li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    geom_bar(mapping = aes(x = cut))
                    # Same as
                    ggplot(data = diamonds) + 
                    stat_count(mapping = aes(x = cut))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/7f4cb432b8891f01b8097e31f286cb54d7473ced/31892/visualize_files/figure-html/unnamed-chunk-31-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>Overriding</h2>
                <ul>
                    <li>Change the default stat</li>
                    <li>Change the aesthetics</li>
                    <li>Diplay various transformations</li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    geom_bar(mapping = aes(x = cut, y = stat(prop), group = 1))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/acddaca9974d1bc66d491397c9a2af7ec470e4ff/48062/visualize_files/figure-html/unnamed-chunk-33-1.png"
                    alt="" width="60%">
            </section>


            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    stat_summary(
                      mapping = aes(x = cut, y = depth),
                      fun.min = min,
                      fun.max = max,
                      fun = median
                    )
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/4f7c8830283cb7009346ed85a8196b06959f5abd/78175/visualize_files/figure-html/unnamed-chunk-34-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>Position Adjustment</h2>
                <ul>
                    <li>ggplot2 will automatically choose positions for geoms</li>
                    <li>You may override by setting <emphcode>position</emphcode>
                        <ul>
                            <li>identity: ignoring other geoms</li>
                            <li>fill: stacking</li>
                            <li>dodge: side by side</li>
                            <li>jitter: add small random noise to avoid overlapping</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    geom_bar(mapping = aes(x = cut, fill = clarity))
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/8110840c1d10cedddc535053908825859595544a/f7d5e/visualize_files/figure-html/unnamed-chunk-37-1.png"
                    alt="" width="60%">
            </section>


            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + 
                    geom_bar(alpha = 1/5, position = "identity")
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/eeb585504858f548f4ed91a08a9ff159b7c6e86b/9ec57/visualize_files/figure-html/unnamed-chunk-38-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/b714164c434b166e783ee626f26a0272e21d77c3/b0cb0/visualize_files/figure-html/unnamed-chunk-39-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = diamonds) + 
                    geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge")
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/df1b0254da67bacb41a51381d310864d3a5a7dc7/10834/visualize_files/figure-html/unnamed-chunk-40-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = mpg) + 
                    geom_point(mapping = aes(x = displ, y = hwy), position = "jitter")
                 </code></pre>
                <img src="https://d33wubrfki0l68.cloudfront.net/74df0885fea263841788c5f4742ac79dde6e023c/8142b/visualize_files/figure-html/unnamed-chunk-42-1.png"
                    alt="" width="60%">
            </section>

            <section>
                <h2>Coordinate Systems</h2>
                <ul>
                    <li>ggplot create Cartesian coordinate system by default occupying the full space</li>
                    <li>Modify by:
                        <ul>
                            <li>coord_flip: swapping x and y</li>
                            <li>coord_quickmap: aspect ratio for maps</li>
                            <li>coord_polar: polar coordinates</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section>
                <h2>Layered Grammar</h2>
                <pre><code data-trim data-noescape class="language-r">
                    ggplot(data = &lt;DATA&gt;) + 
                        &lt;GEOM_FUNCTION&gt;(
                           mapping = aes(&lt;MAPPINGS&gt;),
                           stat = &lt;STAT&gt;, 
                           position = &lt;POSITION&gt;
                        ) +
                        &lt;COORDINATE_FUNCTION&gt; +
                        &lt;FACET_FUNCTION&gt;
                 </code></pre>
            </section>

            <section>
                <h2>VS Basic R</h2>
                <ul>
                    <li>Transform and calculate derived variables</li>
                    <li>Choose visual objects for each variables</li>
                    <li>Decide properties</li>
                    <li>Choose coordinate system and add all objects</li>
                    <li>Adjust positions</li>
                    <li>Add legend</li>
                    <li>Iterate for each subplot</li>
                    <li>ggplot2 does these automatically, usually defaults are acceptable but can be improved</li>
                </ul>
            </section>

            <section>
                <h2>References</h2>
                <ul>
                    <li>R for DS: ch 2 - 4</li>
                    <li>https://r4ds.had.co.nz/</li>
                    <li>https://exts.ggplot2.tidyverse.org/gallery/</li>
                    <li>https://www.rstudio.com/resources/cheatsheets/</li>
                </ul>
            </section>

        </div>
    </div>

    <script src="reveal.js.4.1.3/dist/reveal.js"></script>
    <script src="reveal.js.4.1.3/plugin/zoom/zoom.js"></script>
    <script src="reveal.js.4.1.3/plugin/notes/notes.js"></script>
    <script src="reveal.js.4.1.3/plugin/search/search.js"></script>
    <script src="reveal.js.4.1.3/plugin/markdown/markdown.js"></script>
    <script src="reveal.js.4.1.3/plugin/highlight/highlight.js"></script>
    <script src="reveal.js.4.1.3/plugin/math/math.js"></script>

    <script>
        // Also available as an ES module, see:
        // https://revealjs.com/initialization/
        Reveal.initialize({
            controls: false,
            progress: true,
            center: true,
            hash: true,
            transition: 'slide', // none/fade/slide/convex/concave/zoom

            width: 1024,
            height: 768,

            slideNumber: 'c/t',

            math: {
                // mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
                config: 'TeX-AMS_HTML-full',
                TeX: {
                    Macros: {
                        R: '\\mathbb{R}',
                        set: ['\\left\\{#1 \\; ; \\; #2\\right\\}', 2]
                    }
                }
            },

            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealMath, RevealHighlight]
        });

    </script>

</body>

</html>